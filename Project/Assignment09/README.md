# Redesigning _PAVO_ to Compare Plumage Patch Spectral Data
### Katherine Feldmann

## Biological Question
In each of the plumage patches analyzed by Maia et al. 2013, which species of bird ( _Lamprotornis chloropterus_, _Lamprotornis elisabeth_ or _Lamprotornis acuticaudus_) reflects the most light across all wavelengths? 

## Context
Plumage plays an important role in communicating information in interspecific and intraspecific interactions. This information is often communicated through the light reflectance of a plumage patch. Reflectance properties such as amount and what wavelengths are reflected can vary between species and between the patches on an individual. While this information is valuable and can be obtained from a spectrometer, comprehending the data can be challenging. _Pavo_ is an R package that was generated by Maia et al. 2013 to facilitate processing data obtained from a spectrometer. While this package enables the user to produce aesthetic plots such as _wavelength (nm) vs. reflectance (%)_, it does not allow for the production of multiple plots to compare plumage patches. Therefore, I will begin by replicating the _wavelength (nm) vs. reflectance (%)_ plot using my own code and then incorporate ggplot2's facet_wrap to draw comparisons between plumage patches. 

## Methods
### Source of Data
The data files included in 'glossystarlings' were generated by Maia et al. 2013 to test an R package produced by the group. Creating an R package, _pavo_, to facilitate uploading and processing spectral data was the goal of this study. Spectral data is obtained from a spectrometer and is used to quantify light reflectance. This study aimed to produce an R package that would facilitate processing spectral data and allow researchers to make inferences on how species see color. To test _pavo_, the researchers generated spectral data of glossy starlings. By providing this data to readers, individuals interested in using _pavo_ can replicate the results indicated in the study.

Maia et al. 2013 generated data specifically to use with the _pavo_ package in R. This data contains spectral data of three glossy starling species: _Lamprotornis chloropterus_, _Lamprotornis elisabeth_ and _Lamprotornis acuticaudus_. These birds belong to an African clade and have bright, iridescent colors. While the study does not address the methodology used to produce this data, readers are expected to assume that the provided data was generated with a spectrometer. This information can be gathered from the study as the _pavo_ package was generated to "remove electrical noise arising from the spectrometer."

The data is split into multiple files with each filename consisting of '_species_._bird_ID_._plumage_patch_._measurement_ID_.ttt.' This filename is crucial to the _pavo_ package as it enables files to be read into R. Each file contains wavelength (nm) and transmittance (%) values organized in two columns, separated by a semi-colon, with measurement names and units as headers. Above this two-column table is additional information added by the spectometer on _integration time_, _average number of scans_, _number of pixels used for smoothing_ and _data measured with spectrometer name_. 

Each file is six to seven kilobites in size and there are 396 files contained in a folder called 'glossystarlings.' Each file has 408 lines of text with 400 of those lines containing numerical data for wavelength and transmittance. Among the 396 files, each species has 132 files of data (132 x 3 = 396). Of these files, eleven plumage patches are analyzed four different times. Each time data is collected from a patch, three separate measurements are taken (11 x 4 x 3 = 132).

### Original Use for Data
The data was originally used by Maia et al. 2013 to implement the _pavo_ package in R. By providing readers with example data, interested researchers can download _pavo_ and the provided data to test package capabilites and determine if it is suitable for answering their own questions. If _pavo_ is downloaded for use, researchers can compare the code used on the glossy starling data with that needed to analyze personal data if problems arise. Additionally, if interested users do not have personal data to use with _pavo_, the package can still be downloaded and experimented with using the provided data.

### Project Data Use
One of the figures provided in Maia et al. 2013 that was generated by _pavo_ is a plot of _wavelength (nm) x reflectance (%)_ for a single plumage patch. This plot depicts what percentage of light at all wavelengths is reflected by the specified patch for each species. This plot is beneficial as it allows the reader to easily determine what wavelengths are primarily being reflected by each species and how the species compare with regards to light reflectance. Being able to compare this data across multiple patches, however, has biological implications and could be beneficial for scientific research. _Pavo_ does not allow multiple patches to be plotted in one figure. Therefore, this project aims to replicate the figure provided in Maia et al. 2013 prior to using facet_wrap in ggplot2 to graph all plumage patches in one figure. From this one plot, it can be determined which species reflects the most light in each of the plumage patches analyzed by Maia et al. 2013.

To produce one plot with all of the plumage patches in the data, this project was broken up into three steps. **Step one** involved learning how to use _pavo_ to reproduce the plot provided in the paper ![Pavo Plot](https://github.com/kbfeldmann/CompBioLabsAndHomework/blob/master/Project/Assignment09/Pavo_Plot.pdf). **Step two** consisted of writing code to read in data from the .ttt files, generate a usable data frame and replicate the previous plot ![Replicate Pavo Plot](https://github.com/kbfeldmann/CompBioLabsAndHomework/blob/master/Project/Assignment09/Replicate_Pavo_Plot.pdf). Finally, **step three** added facet_wrap to the previous code to generate a single figure with multiple plots for each of the eleven plumage patches in the glossy starling data ![Multiple Patch Plot](https://github.com/kbfeldmann/CompBioLabsAndHomework/blob/master/Project/Assignment09/Multiple_Patch_Plot.pdf).

## Results and Conclusions
This project resulted in successful implementation of R code to produce a single figure that contains plots for every plumage patch analyzed. This figure contains eleven plots (belly, cheek, chest, head, mantle, neck, rump, shoulder, tail, throat and wing) with each plot displaying _wavelength (nm) x reflectance (%)_ data for an individual plumage patch. Each plot in the final figure contains the information present in the plot for the belly patch provided in the paper. By using facet_wrap in ggplot to produce one figure for all of the patches rather than eleven figures, it is easy to see what patches amongst the three species reflect the most light. For example, between the eleven patches, it is clear that in all three species the cheek patch reflects the least amount of light across all wavelengths. Additionally, in the tail and throat patches, LAAC (_Lamprotornis acuticaudus_) and LAEL (_Lamprotornis elisabeth_ ) reflect more light than LACL (_Lamprotornis chloropterus_).

With regards to the question, **"In each of the plumage patches analyzed by Maia et al. 2013, which species of bird ( _Lamprotornis chloropterus_, _Lamprotornis elisabeth_ or _Lamprotornis acuticaudus_) reflects the most light across all wavelengths?"**, one can use this final figure to discern a potential answer. Using the figure produced in ggplot with facet_wrap, LAEL appears to reflect the most light in the belly patch with the majority of reflectance being wavelengths in the 400 - 500 nm range. Likewise, if one were interested in the shoulder patch, the same figure could provide insight into that question as the shoulder plot suggests that LACL reflects the most light in the 500 - 600 nm range. Should someone be interested in any of the other patches analyzed, this single figure could provide the information needed to discern the desired information.

Beyond addressing this project's stated question, this figure could provide insight into many other biological questions that could be asked about this data. For example, one could ask "which plumage patch reflects the most light in LAAC?" and upon further analysis of the figure, they would determine that the head patch reflects the most light in LAAC. There are numerous biological questions that could be asked and answered with the help of this one figure. While the same results could be accomplished by creating eleven plots, combining the plots into one figure where the axes line up and the figures are neatly arranged is beneficial to anyone trying to draw conclusions from these plumage patch plots.

![Multiple Patch Plot](https://github.com/kbfeldmann/CompBioLabsAndHomework/blob/master/Project/Assignment09/Multiple_Patch_Plot.pdf)

## References
Maia R, Eliason CM, Bitton P, Doucet SM, Shawkey MD (2013) pavo: an R package for the analysis, visualization and organization of spectral data. Methods in Ecology and Evolution 4(10): 906â€“913. https://doi.org/10.1111/2041-210X.12069

Maia R, Eliason CM, Bitton P, Doucet SM, Shawkey MD (2013) Data from: pavo: an R package for the analysis, visualization and organization of spectral data. Dryad Digital Repository. https://doi.org/10.5061/dryad.298b1
